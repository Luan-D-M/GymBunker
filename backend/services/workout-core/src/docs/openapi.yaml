openapi: 3.0.0
info:
  title: GymBunker Workout Core
  version: 1.0.0
  description: API for managing user workouts, exercises, and history.

servers:
  - url: http://localhost:3000/user
    description: Local Development

security:
  - bearerAuth: []

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        **JWT Authorization header using the Bearer scheme.**
        
        Enter **ONLY** your token in the text box below.
        Do **NOT** type "Bearer " (Swagger UI adds it automatically).
        
        Example: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`
  
  schemas:
    Exercise:
      type: object
      required: [name]
      properties:
        name:
          type: string
          example: "Bench Press"
        weight:
          type: number
          nullable: true
          example: 80
        number_reps:
          type: integer
          nullable: true
          example: 10
        number_sets:
          type: integer
          nullable: true
          example: 4
        rest_time_in_seconds:
          type: integer
          nullable: true
          example: 60

    Workout:
      type: object
      required: [workout_name, exercises]
      properties:
        workout_name:
          type: string
          example: "Push Day"
        exercises:
          type: array
          items:
            $ref: '#/components/schemas/Exercise'

    UserWorkoutProfile:
      type: object
      properties:
        user_id:
          type: string
          example: "user_123"
        workouts:
          type: array
          items:
            $ref: '#/components/schemas/Workout'

    Error:
      type: object
      properties:
        message:
          type: string
          example: "Error message details"

paths:
  # --- GET USER DATA ---
  /:
    get:
      summary: Get User Profile & Workouts
      tags: [User]
      responses:
        200:
          description: Returns full user profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserWorkoutProfile'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  # --- ADD WORKOUT ---
  /add-workout:
    post:
      summary: Add a new workout
      tags: [Workouts]
      requestBody:
        description: "The **Workout** object to create. The `workout_name` must be unique for the user."
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Workout'
      responses:
        201:
          description: Workout created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserWorkoutProfile'
        400:
          description: Validation Error (Invalid data)
        404:
          description: User not found
        409:
          description: Workout name already exists

  # --- UPDATE WORKOUT ---
  /update-workout/{workoutName}:
    parameters:
      - in: path
        name: workoutName
        required: true
        schema:
          type: string
        description: "The current name of the workout to update."
    post:
      summary: Update an existing workout
      tags: [Workouts]
      requestBody:
        description: "The **Workout** object with updated exercises. **Important:** The `workout_name` field in this body MUST match the `workoutName` in the URL path."
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Workout'
      responses:
        200:
          description: Workout updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserWorkoutProfile'
        400:
          description: Bad Request (Invalid input or data mismatch)
        404:
          description: User or workout wasn't found.

  # --- DELETE WORKOUT ---
  /delete-workout/{workoutName}:
    parameters:
      - in: path
        name: workoutName
        required: true
        schema:
          type: string
        description: "The name of the workout to delete."
    delete:
      summary: Delete a workout
      tags: [Workouts]
      responses:
        200:
          description: Workout deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Workout deleted successfully"
                  data:
                    $ref: '#/components/schemas/UserWorkoutProfile'